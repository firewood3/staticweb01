<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="/lib/boostrap/bootstrap-4.6.0-dist/css/bootstrap.min.css" type="text/css">
  <link rel="stylesheet" href="/lib/boostrap/icons-1.3.0/font/bootstrap-icons.css" type="text/css">

  <script src="/lib/jquery/jquery-3.5.1/jquery.min.js"></script>
  <script src="/lib/popper/popper-1.16.1/popper.min.js"></script>
  <script src="/lib/boostrap/bootstrap-4.6.0-dist/js/bootstrap.min.js"></script>
  <script src="/lib/lodash/lodash.min.js"></script>
  <script src="/lib/xlsx/xlsx.full.min.js"></script>
  <script src="/lib/file-saver/FileSaver.js"></script>

  <script>
    var data = [
      {'부서명': '건축과', '접속수' : 9000},
      {'부서명': '도시계획과', '접속수' : 8000},
      {'부서명': '건설과', '접속수' : 7000},
      {'부서명': '농정과', '접속수' : 6000},
      {'부서명': '공원녹지과', '접속수' : 5000},
    ];

    function downloadExcel() {
      var fileName = '부서별 접속통계.xlsx';
      var sheetName = 'sheet1';
      var workbook = XLSX.utils.book_new();
      var worksheet = XLSX.utils.json_to_sheet(data);
      XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);
      var excelFile = XLSX.write(workbook, {bookType: 'xlsx', type: 'binary'});
      saveAs(new Blob([s2ab(excelFile)], {type:'application/octet-stream'}), fileName);

      function s2ab(s) {
        var buf = new ArrayBuffer(s.length); //convert s to arrayBuffer
        var view = new Uint8Array(buf);  //create uint8array as viewer
        for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF; //convert to octet
        return buf;
      }
    }

    $(document).ready(function() {
      $("#excelFileExport").click(function () {
        downloadExcel();
      });
    });
  </script>
</head>
<body>
부서별 접속통계 엑셀 다운로드 : <input type="button" id="excelFileExport" value="엑셀 파일 다운로드(JSON)" />
</body>
</html>
